{
  "files": [
    {
      "content": "import { cre, ok, consensusIdenticalAggregation, Runner, type Runtime, type HTTPSendRequester, type CronTrigger } from \"@chainlink/cre-sdk\";\nimport { z } from \"zod\";\n\nconst configSchema = z.object({\n  schedule: z.string().default(\"TZ=UTC 0 0 */1 * * *\"),\n});\n\ntype Config = z.infer<typeof configSchema>;\n\nconst fetch_node_1772176743838_1 = (sendRequester: HTTPSendRequester, config: any, apiKey: string) => {\n  const body = {\n    system_instruction: {\n      parts: [{ text: \"Let's play the rock, paper, scissor game\" }],\n    },\n    contents: [\n      { role: \"user\", parts: [{ text: \"Choose your move\" }] },\n    ],\n    generationConfig: {\n      temperature: 0.7,\n    },\n  };\n\n  const bodyBytes = new TextEncoder().encode(JSON.stringify(body));\n\n  const req = {\n    url: \"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-lite:generateContent\",\n    method: \"POST\" as const,\n    body: Buffer.from(bodyBytes).toString(\"base64\"),\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"x-goog-api-key\": apiKey,\n    },\n  };\n\n  const resp = sendRequester.sendRequest(req).result();\n\n  if (!ok(resp)) {\n    throw new Error(`AI call failed with status: ${resp.statusCode}`);\n  }\n\n  return JSON.parse(Buffer.from(resp.body, \"base64\").toString(\"utf-8\"));\n};\n\nconst onCronTrigger = (runtime: Runtime<Config>, triggerData: CronTrigger): string => {\n  const httpClient = new cre.capabilities.HTTPClient();\n\n  const __stringify = (v: unknown) => JSON.stringify(v, (_, x) => typeof x === \"bigint\" ? x.toString() : x);\n\n  // AI\n  const _aiApiKey_node_1772176743838_1 = runtime.getSecret({ id: \"GEMINI_KEY\" }).result();\n  const step_node_1772176743838_1 = httpClient.sendRequest(runtime, fetch_node_1772176743838_1, consensusIdenticalAggregation())(runtime.config, _aiApiKey_node_1772176743838_1.value).result();\n  runtime.log(`[AI] ${__stringify(step_node_1772176743838_1)}`);\n  return \"Workflow completed\";\n};\n\nconst initWorkflow = (config: Config) => {\n  return [\n    cre.handler(\n      new cre.capabilities.CronCapability().trigger({\n        schedule: config.schedule,\n      }),\n      onCronTrigger,\n    ),\n  ];\n};\n\nexport async function main() {\n  const runner = await Runner.newRunner<Config>({ configSchema });\n  await runner.run(initWorkflow);\n}\n\nmain();\n",
      "path": "main.ts"
    },
    {
      "content": "{\n  \"schedule\": \"TZ=UTC 0 0 */1 * * *\"\n}\n",
      "path": "config.staging.json"
    },
    {
      "content": "secretsNames:\n  GEMINI_KEY:\n    - GEMINI_KEY_VALUE\n",
      "path": "secrets.yaml"
    },
    {
      "content": "staging-settings:\n  user-workflow:\n    workflow-name: \"k17dnx68tjya99nmh71cehbe9181z1gj-staging\"\n  workflow-artifacts:\n    workflow-path: \"./main.ts\"\n    config-path: \"./config.staging.json\"\n    secrets-path: \"../secrets.yaml\"\nproduction-settings:\n  user-workflow:\n    workflow-name: \"k17dnx68tjya99nmh71cehbe9181z1gj-production\"\n  workflow-artifacts:\n    workflow-path: \"./main.ts\"\n    config-path: \"./config.production.json\"\n    secrets-path: \"../secrets.yaml\"\n",
      "path": "workflow.yaml"
    },
    {
      "content": "staging-settings:\n  rpcs:\n    - chain-name: ethereum-testnet-sepolia\n      url: https://0xrpc.io/sep\n",
      "path": "project.yaml"
    },
    {
      "content": "{\n  \"name\": \"k17dnx68tjya99nmh71cehbe9181z1gj\",\n  \"version\": \"1.0.0\",\n  \"main\": \"dist/main.js\",\n  \"private\": true,\n  \"scripts\": {\n    \"postinstall\": \"bun x cre-setup\"\n  },\n  \"dependencies\": {\n    \"@chainlink/cre-sdk\": \"^1.0.9\",\n    \"zod\": \"^3.24\"\n  },\n  \"devDependencies\": {\n    \"@types/bun\": \"1.2.21\"\n  }\n}\n",
      "path": "package.json"
    },
    {
      "content": "{\n  \"compilerOptions\": {\n    \"target\": \"ES2022\",\n    \"module\": \"ES2022\",\n    \"moduleResolution\": \"bundler\",\n    \"strict\": true,\n    \"esModuleInterop\": true,\n    \"skipLibCheck\": true,\n    \"forceConsistentCasingInFileNames\": true,\n    \"outDir\": \"./dist\",\n    \"rootDir\": \".\"\n  },\n  \"include\": [\"*.ts\"]\n}\n",
      "path": "tsconfig.json"
    },
    {
      "content": "# Environment variables for CRE simulation\n# Fill in real values before running `cre simulate`\n\nGEMINI_KEY_VALUE=<GEMINI_KEY>\n",
      "path": ".env"
    }
  ],
  "status": "success",
  "warnings": []
}