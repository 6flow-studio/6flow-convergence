{
  "files": [
    {
      "content": "import { cre, ok, consensusIdenticalAggregation, Runner, type Runtime, type HTTPSendRequester, type HTTPPayload } from \"@chainlink/cre-sdk\";\n\ntype Config = Record<string, never>;\n\nconst fetch_ai_1 = (sendRequester: HTTPSendRequester, config: Config) => {\n  const body = {\n    model: \"gpt-4o-mini\",\n    messages: [\n      { role: \"system\", content: \"You are an operations assistant. Return a concise next-action recommendation in JSON.\" },\n      { role: \"user\", content: \"Analyze the incoming webhook request and return one clear recommended action.\" },\n    ],\n    temperature: 0.2,\n    max_tokens: 200,\n  };\n\n  const bodyBytes = new TextEncoder().encode(JSON.stringify(body));\n\n  const req = {\n    url: \"https://api.openai.com/v1/chat/completions\",\n    method: \"POST\" as const,\n    body: Buffer.from(bodyBytes).toString(\"base64\"),\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n  };\n\n  const resp = sendRequester.sendRequest(req).result();\n\n  if (!ok(resp)) {\n    throw new Error(`AI call failed with status: ${resp.statusCode}`);\n  }\n\n  return JSON.parse(Buffer.from(resp.body, \"base64\").toString(\"utf-8\"));\n};\n\nconst onHttpRequest = (runtime: Runtime<Config>, triggerData: HTTPPayload): string => {\n  const httpClient = new cre.capabilities.HTTPClient();\n\n  // Decide Next Action\n  const step_ai_1 = httpClient.sendRequest(runtime, fetch_ai_1, consensusIdenticalAggregation())(runtime.config).result();\n  return step_ai_1.choices[0].message.content;\n};\n\nconst initWorkflow = (config: Config) => {\n  return [\n    cre.handler(\n      new cre.capabilities.HTTPCapability().trigger({}),\n      onHttpRequest,\n    ),\n  ];\n};\n\nexport async function main() {\n  const runner = await Runner.newRunner<Config>();\n  await runner.run(initWorkflow);\n}\n\nmain();\n",
      "path": "main.ts"
    },
    {
      "content": "{\n\n}\n",
      "path": "config.staging.json"
    },
    {
      "content": "secretsNames:\n  OPENAI_API_KEY:\n    - OPENAI_API_KEY\n",
      "path": "secrets.yaml"
    },
    {
      "content": "staging-settings:\n  user-workflow:\n    workflow-name: \"mockup-workflow-staging\"\n  workflow-artifacts:\n    workflow-path: \"./main.ts\"\n    config-path: \"./config.staging.json\"\n    secrets-path: \"../secrets.yaml\"\nproduction-settings:\n  user-workflow:\n    workflow-name: \"mockup-workflow-production\"\n  workflow-artifacts:\n    workflow-path: \"./main.ts\"\n    config-path: \"./config.production.json\"\n    secrets-path: \"../secrets.yaml\"\n",
      "path": "workflow.yaml"
    },
    {
      "content": "staging-settings:\n  rpcs:\n    - chain-name: ethereum-testnet-sepolia\n      url: https://0xrpc.io/sep\n",
      "path": "project.yaml"
    },
    {
      "content": "{\n  \"name\": \"mockup-workflow\",\n  \"version\": \"1.0.0\",\n  \"main\": \"dist/main.js\",\n  \"private\": true,\n  \"scripts\": {\n    \"postinstall\": \"bun x cre-setup\"\n  },\n  \"dependencies\": {\n    \"@chainlink/cre-sdk\": \"^1.0.9\",\n    \"zod\": \"^3.24\"\n  },\n  \"devDependencies\": {\n    \"@types/bun\": \"1.2.21\"\n  }\n}\n",
      "path": "package.json"
    },
    {
      "content": "{\n  \"compilerOptions\": {\n    \"target\": \"ES2022\",\n    \"module\": \"ES2022\",\n    \"moduleResolution\": \"bundler\",\n    \"strict\": true,\n    \"esModuleInterop\": true,\n    \"skipLibCheck\": true,\n    \"forceConsistentCasingInFileNames\": true,\n    \"outDir\": \"./dist\",\n    \"rootDir\": \".\"\n  },\n  \"include\": [\"*.ts\"]\n}\n",
      "path": "tsconfig.json"
    },
    {
      "content": "# Environment variables for CRE simulation\n# Fill in real values before running `cre simulate`\n\nOPENAI_API_KEY=<OPENAI_API_KEY>\n",
      "path": ".env"
    }
  ],
  "status": "success",
  "warnings": []
}